import{ak as De,ap as O,r as m,j as a,a as e,bZ as Re,h as ke,E as de,p as L,N as ye,m as Se,L as h,d as U,a3 as ee,cw as xe,aU as Le,u as j,P as Y,F as W,I as _e,f as Oe,cx as oe,bM as ie,C as B,b as re,aw as Te,q as Z,s as G,H as Ve,_ as Me,cm as Fe,a7 as be,a2 as ue,aa as Ue,ab as Ee,aP as $e,cd as He,K as We,ai as Be,w as Ge,an as Ye,ba as me,bg as ze}from"./index-2be1dfc8.js";import{T as Ae}from"./Textarea-c3e72c1f.js";var Ke=function(s){return new Promise(function(r){setTimeout(r,s)})};const fe=De(Ke),x={snapBackDuration:300,maxTilt:5,bouncePower:.1,swipeThreshold:100},je=t=>{const s=window.getComputedStyle(t),r=s.getPropertyValue("width"),g=Number(r.split("px")[0]),E=s.getPropertyValue("height"),I=Number(E.split("px")[0]);return{x:g,y:I}},Pe=(t,s)=>Math.sqrt(Math.pow(t,2)+Math.pow(s,2)),qe=(t,s=1)=>{const r=Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2));return{x:t.x*s/r,y:t.y*s/r}},he=async(t,s,r=!1)=>{const g=le(t),E=je(document.body),I=Pe(E.x,E.y),o=Pe(s.x,s.y),f=I/o,l=I/o,v=ve(s.x*l+g.x,-s.y*l+g.y);let u="";const c=200;r?t.style.transition="ease "+f+"s":t.style.transition="ease-out "+f+"s",J(t)===0?u=X((Math.random()-.5)*c):J(t)>0?u=X(Math.random()*c/2+J(t)):u=X((Math.random()-1)*c/2+J(t)),t.style.transform=v+u,await fe(f*1e3)},we=async t=>{t.style.transition=x.snapBackDuration+"ms";const s=le(t),r=ve(s.x*-x.bouncePower,s.y*-x.bouncePower),g=X(J(t)*-x.bouncePower);t.style.transform=r+g,await fe(x.snapBackDuration*.75),t.style.transform="none",await fe(x.snapBackDuration),t.style.transition="10ms"},Ie=t=>{if(Math.abs(t.x)>Math.abs(t.y)){if(t.x>x.swipeThreshold)return"right";if(t.x<-x.swipeThreshold)return"left"}else{if(t.y>x.swipeThreshold)return"up";if(t.y<-x.swipeThreshold)return"down"}return"none"},Ce=(t,s)=>{const r=s.x-t.x,g=t.y-s.y,E=(s.time-t.time)/1e3;return{x:r/E,y:g/E}},ve=(t,s)=>"translate("+t+"px)",X=t=>"rotate("+t+"deg)",le=t=>{const s=window.getComputedStyle(t),r=new DOMMatrix(s.transform);return{x:r.m41,y:-r.m42}},J=t=>{const s=window.getComputedStyle(t),r=new DOMMatrix(s.transform);return-Math.asin(r.m21)/(2*Math.PI)*360},Je=(t,s,r,g)=>{const E={x:t.x+r.x,y:t.y+r.y},I={x:E.x,y:E.y,time:new Date().getTime()},o=ve(E.x),f=Ce(g,I).x/1e3,l=X(f*x.maxTilt);return s.style.transform=o+l,I},ge=t=>{const s=t.targetTouches[0];return{x:s.clientX,y:s.clientY}},pe=t=>({x:t.clientX,y:t.clientY}),Xe=O.forwardRef(({flickOnSwipe:t=!0,children:s,onSwipe:r,onCardLeftScreen:g,className:E,preventSwipe:I=[],swipeRequirementType:o="velocity",swipeThreshold:f=x.swipeThreshold,onSwipeRequirementFulfilled:l,onSwipeRequirementUnfulfilled:v},u)=>{x.swipeThreshold=f;const c=O.useRef(!1),p=O.useRef();O.useImperativeHandle(u,()=>({async swipe(T="right"){r&&r(T);const y=1e3,A=(Math.random()-.5)*100;T==="right"?await he(p.current,{x:y,y:A},!0):T==="left"&&await he(p.current,{x:-y,y:A},!0),p.current.style.display="none",g&&g(T)},async restoreCard(){p.current.style.display="block",await we(p.current)}}));const i=O.useCallback(async(T,y)=>{if(c.current)return;c.current=!0;const A=le(T),d=Ie(o==="velocity"?y:A);if(d!=="none"&&(r&&r(d),t&&!I.includes(d))){const P=o==="velocity"?y:qe(A,600);await he(T,P),T.style.display="none",g&&g(d);return}we(T)},[c,t,r,g,I,o]),w=O.useCallback(()=>{c.current=!1},[c]);return O.useLayoutEffect(()=>{let T={x:null,y:null},y={x:0,y:0},A={x:0,y:0,time:new Date().getTime()},d=!1,P="none";p.current.addEventListener("touchstart",b=>{b.preventDefault(),w(),T={x:-ge(b).x,y:-ge(b).y}}),p.current.addEventListener("mousedown",b=>{b.preventDefault(),d=!0,w(),T={x:-pe(b).x,y:-pe(b).y}});const R=b=>{if(l||v){const n=Ie(o==="velocity"?y:le(p.current));n!==P&&(P=n,P==="none"?v&&v():l&&l(n))}const M=Je(b,p.current,T,A);y=Ce(A,M),A=M};p.current.addEventListener("touchmove",b=>{b.preventDefault(),R(ge(b))}),p.current.addEventListener("mousemove",b=>{b.preventDefault(),d&&R(pe(b))}),p.current.addEventListener("touchend",b=>{b.preventDefault(),i(p.current,y)}),p.current.addEventListener("mouseup",b=>{d&&(b.preventDefault(),d=!1,i(p.current,y))}),p.current.addEventListener("mouseleave",b=>{d&&(b.preventDefault(),d=!1,i(p.current,y))})},[]),O.createElement("div",{ref:p,className:E},s)});function Ne(){const{View:t}=m.useContext(z),[s,r]=t;return a("div",{className:"home-header",children:[e(Re,{onClick:()=>r("profile")}),e("img",{className:"logo",src:"./assets/img/icons/tinder/logo.svg",onClick:()=>r("home")}),e(ke,{onClick:()=>r("messageList")})]})}const $={account:{name:"James",bio:"I'm a cool guy",dob:9624888e5,photos:["https://r2.fivemanage.com/images/GRBUI6C4orbD.webp","https://r2.fivemanage.com/images/98avzSwlgzsg.webp","https://r2.fivemanage.com/images/rafgjPwSYnn2.png"],showMen:!1,showWomen:!0,isMale:!0,active:!0},accounts:[{number:"1",dob:9653888e5,name:"Jessica",bio:"Swipe right if you like dogs",photos:["https://r2.fivemanage.com/images/oRKcdeTA8oBy.png"],isMale:!1,matched:!0},{number:"2",dob:9653888e5,name:"Klara",bio:"Member of Lost MC, looking for a good time",photos:["https://r2.fivemanage.com/images/787FMzhn5xD5.png","https://r2.fivemanage.com/images/ZsmnyJOA2rc5.png"],isMale:!1,liked:!0},{number:"3",dob:9653888e5,name:"Steph",bio:"Evening strolls are my thing",photos:["https://r2.fivemanage.com/images/7zj3Xgy6FsXK.png"],matched:!0,isMale:!1,lastMessage:"I'm perfect, you look good!"}],messages:{3:[{sender:"1",content:"Im perfect, you look good!",timestamp:Date.now()-1e3*60*60*24*1},{sender:"1234567890",content:"I'm good, how about you?",timestamp:Date.now()-1e3*60*60*24*2},{sender:"1",content:"Hey, how are you?",timestamp:Date.now()-1e3*60*60*24*3}]}};function Ze(){const{View:t,User:s,Account:r}=m.useContext(z),[g,E]=t,[I,o]=s,[f,l]=r,[v,u]=m.useState([]),[c,p]=m.useState(0),[i,w]=m.useState(),T=m.useRef(c),y=m.useRef(0),[A,d]=m.useState([]),[P,R]=m.useState(0),[b,M]=m.useState(!1),[n,S]=m.useState(null);let[D,V]=m.useState("");m.useEffect(()=>{de("Tinder")&&L("Tinder",{action:"getFeed",page:0},$.accounts.filter(N=>!N.matched)).then(N=>{N&&N.length>0?(u(N),p(N.length-1),y.current=N.length,d(Array(N.length).fill(0).map(C=>O.createRef()))):M(!0)})},[]);const H=N=>{p(N),T.current=N},K=c<v.length-1,te=c>=0,se=(N,C,_)=>{w(N),H(_-1),F(),N==="right"?L("Tinder",{action:"swipe",like:!0,number:C.number},$.accounts.find(ne=>ne.liked&&ne.number==C.number)).then(ne=>{ne&&S(C)}):N==="left"&&L("Tinder",{action:"swipe",like:!1,number:C.number})},ae=(N,C)=>{T.current>=C&&A[C].current.restoreCard()},q=async N=>{te&&c<v.length&&(await A[c].current.swipe(N),F())},k=async()=>{var C,_;if(!K)return;const N=c+1;H(N),await((_=(C=A[N])==null?void 0:C.current)==null?void 0:_.restoreCard())},F=()=>{if(y.current>1){y.current=y.current-1;return}L("Tinder",{action:"getFeed",page:P+1}).then(N=>{if(N)if(N&&N.length>0){R(P+1);let C=N.length+v.length;u(_=>(_=[..._,...N],_)),y.current=N.length,p(C-1),d(Array(C).fill(0).map(_=>O.createRef()))}else M(!0)})};return a("div",{className:`home-wrapper slide ${g=="profile"?"left":"right"}`,children:[e(Ne,{}),e(ye,{children:n&&a(Se.div,{initial:{opacity:0,scale:.1},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.1},transition:{duration:.3,ease:"easeInOut"},className:"match",style:{backgroundImage:`url(${n.photos[0]})`},children:[e("img",{className:"match-image",src:"./assets/img/icons/tinder/match.png"}),a("div",{className:"likes-too",children:[n.name," ",h("APPS.TINDER.LIKES_YOU_TOO").toLowerCase()]}),a("div",{className:"input",children:[e(U,{type:"text",placeholder:h("APPS.TINDER.SAY_SOMETHING_NICE"),onChange:N=>V(N.target.value)}),e("div",{className:"send",onClick:()=>{L("Tinder",{action:"sendMessage",data:{recipient:n.number,content:D}},!0).then(N=>{N&&(o(n),E("message"))})},children:h("APPS.TINDER.SEND")})]}),e("div",{className:"keep-swiping",onClick:()=>S(null),children:h("APPS.TINDER.KEEP_SWIPING")})]})}),a("div",{className:"home-body",children:[a("div",{className:"cards",children:[b&&e("div",{className:"card no-more",children:e("div",{children:h("APPS.TINDER.NO_MORE")})}),!f.active&&e("div",{className:"card no-more",children:e("div",{children:h("APPS.TINDER.HIDDEN_PROFILE")})}),f.active&&v.map((N,C)=>e(Xe,{ref:A[C],className:"swipe",onSwipe:_=>se(_,N,C),onCardLeftScreen:()=>ae(N,C),children:e(Qe,{user:N})},C))]}),a("div",{className:"actions",children:[e("div",{className:"button",onClick:()=>q("left"),children:e(ee,{style:{color:"#F24C65"}})}),e("div",{className:`button small ${K?"":"disabled"}`,onClick:()=>k(),children:e(xe,{style:{rotate:"180deg",color:"#F2B721"}})}),e("div",{className:"button",onClick:()=>q("right"),children:e(Le,{style:{color:"#3CDBA7"}})})]})]})]})}const Qe=t=>{let s=t.user;const[r,g]=m.useState(0),[E,I]=m.useState(0);return m.useEffect(()=>{I(Q(s.dob))},[s]),a("div",{className:"card",style:{backgroundImage:`url(${s.photos[r]})`},onClick:o=>{r<s.photos.length-1?g(r+1):g(0)},children:[s.photos.length>1&&e("div",{className:"image-count",children:s.photos.map((o,f)=>e("div",{className:`image ${f==r?"active":""}`,onClick:l=>{l.stopPropagation(),g(f)}}))}),a("div",{className:"card-content",children:[a("div",{className:"name",children:[s.name," ",e("span",{children:E})]}),e("div",{className:"description",children:s.bio})]})]})};function et(){const{LoggedIn:t,Account:s}=m.useContext(z),r=j(Y.PhoneNumber),[g,E]=s,[I,o]=t,[f,l]=m.useState("notLoggedIn"),[v,u]=m.useState(0),[c,p]=m.useState({});m.useEffect(()=>{de("Tinder")&&(f=="notLoggedIn"?Y.Styles.TextColor.set("#ffffff"):Y.Styles.TextColor.set("#000000"))},[f]);const[i,w]=m.useState({name:null,photos:[],_dob:{day:"",month:"",year:""},dob:null,bio:null,showMen:!1,showWomen:!1,isMale:null,active:!0}),T=d=>{var P,R,b;switch(d){case 0:let M=new Date(`${(P=i._dob)==null?void 0:P.year}/${(R=i._dob)==null?void 0:R.month}/${(b=i._dob)==null?void 0:b.day}`);if(y(M)){let n=Q(M);i.name&&i.name.length>=2&&n>=18&&n<=100&&(w({...i,dob:M.getTime()}),u(d+1))}break;case 1:i.photos.length>0&&u(d+1);break;case 2:i.bio&&i.bio.length>=10&&u(d+1);break;case 3:(i.showMen||i.showWomen)&&u(d+1);break;case 4:(i.isMale==!0||i.isMale==!1)&&L("Tinder",{action:"createAccount",data:{...i,dob:new Date(i.dob).toISOString().split("T")[0]}},!0).then(n=>{if(!n)return Z("error","Failed to create account");G.APPS.TINDER.account.set(i),E(i),o(!0)});break}},y=d=>d.getTime()===d.getTime();let A=[h("APPS.TINDER.CREATE_ACCOUNT"),h("APPS.TINDER.ADD_PHOTOS"),h("APPS.TINDER.DESCRIPTION"),h("APPS.TINDER.SHOW_ME"),h("APPS.TINDER.I_AM")];return e("div",{className:"login-container",style:{background:f==="notLoggedIn"?"linear-gradient(45deg, #ff4573, #ff5f65)":"#ffffff"},children:f==="notLoggedIn"?a(W,{children:[a("div",{className:"logo",children:[e("img",{src:"./assets/img/icons/tinder/logo-white.svg"}),e("div",{className:"logo-text",children:h("APPS.TINDER.TITLE").toLowerCase()})]}),a("div",{className:"buttons",children:[e("div",{className:"disclamer",children:h("APPS.TINDER.AGREE_TERMS")}),e("div",{className:"button create",onClick:()=>l("createAccount"),children:h("APPS.TINDER.CREATE_ACCOUNT")})]})]}):a("div",{className:"create-account",children:[a("div",{className:"login-header",children:[e(_e,{onClick:()=>{v>0?u(v-1):l("notLoggedIn")}}),e("div",{className:"title",children:A[v]})]}),v==0&&e(W,{children:a("div",{className:"form-body",children:[e(U,{defaultValue:Oe(r),type:"text",disabled:!0}),e(U,{placeholder:"Name",type:"text",maxLength:25,onChange:d=>{w({...i,name:d.target.value}),d.target.value.length>=3?p({...c,name:!0}):p({...c,name:!1})}}),a("div",{className:"dob",children:[a("div",{className:"inputs",children:[e(U,{placeholder:"MM",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:2,maxLength:2,onChange:d=>{w({...i,_dob:{...i._dob,month:d.target.value}})}}),e("span",{children:"/"}),e(U,{placeholder:"DD",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:2,maxLength:2,onChange:d=>{w({...i,_dob:{...i._dob,day:d.target.value}})}}),e("span",{children:"/"}),e(U,{placeholder:"YYYY",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:4,maxLength:4,onChange:d=>{var M,n,S;let P={...i,_dob:{...i._dob,year:d.target.value}};w(P);let R=new Date(`${(M=P._dob)==null?void 0:M.year}/${(n=P._dob)==null?void 0:n.month}/${(S=P._dob)==null?void 0:S.day}`),b=Q(R);b>=18&&b<100?p({...c,18:!0}):p({...c,18:!1})}})]}),e("div",{className:"disclamer",children:h("APPS.TINDER.AGE_PUBLIC")}),a("div",{className:"requirement",children:[c[18]?e(oe,{className:"green"}):e(ie,{className:"red"}),h("APPS.TINDER.BE_OVER_18")]}),a("div",{className:"requirement",children:[c.name?e(oe,{className:"green"}):e(ie,{className:"red"}),h("APPS.TINDER.NAME_MINIMUM")]})]})]})}),v==1&&a(W,{children:[e("div",{className:"photo-grid",children:[...Array(6)].map((d,P)=>{var b;let R=((b=i.photos)==null?void 0:b[P-1])||P==0;return i.photos[P]?e("div",{className:"photo",style:{backgroundImage:`url(${i.photos[P]})`},children:e("div",{className:"button remove",onClick:()=>{let M=i.photos;M.splice(P,1),w({...i,photos:M}),M.length==0&&p({...c,photos:!1})},children:e(ee,{})})}):e("div",{className:"photo",children:R&&e("div",{className:"button add",onClick:()=>{var M,n,S;B.Gallery.set({allowExternal:(S=(n=(M=re)==null?void 0:M.value)==null?void 0:n.AllowExternal)==null?void 0:S.Spark,onSelect:D=>w({...i,photos:[...i.photos,D.src]})}),p({...c,photos:!0})},children:e(Te,{})})})})}),a("div",{className:"requirement",children:[c.photos?e(oe,{className:"green"}):e(ie,{className:"red"}),h("APPS.TINDER.PHOTOS_MINIMUM")]})]}),v==2&&a(W,{children:[e(Ae,{placeholder:"Description",maxLength:200,onChange:d=>{w({...i,bio:d.target.value}),d.target.value.length>=10?p({...c,bio:!0}):p({...c,bio:!1})}}),a("div",{className:"requirement",children:[c.bio?e(oe,{className:"green"}):e(ie,{className:"red"}),h("APPS.TINDER.DESCRIPTION_MINIMUM")]})]}),v==3&&e(W,{children:a("div",{className:"showme",children:[e("div",{className:`button border ${i.showWomen&&!i.showMen?"active":""}`,onClick:()=>{w({...i,showMen:!1,showWomen:!0})},children:h("APPS.TINDER.WOMEN")}),e("div",{className:`button border ${i.showMen&&!i.showWomen?"active":""}`,onClick:()=>{w({...i,showMen:!0,showWomen:!1})},children:h("APPS.TINDER.MEN")}),e("div",{className:`button border ${i.showMen&&i.showWomen?"active":""}`,onClick:()=>{w({...i,showMen:!0,showWomen:!0})},children:h("APPS.TINDER.EVERYONE")})]})}),v==4&&e(W,{children:a("div",{className:"showme",children:[e("div",{className:`button border ${i.isMale===!0?"active":""}`,onClick:()=>{w({...i,isMale:!0})},children:h("APPS.TINDER.MALE")}),e("div",{className:`button border ${i.isMale===!1?"active":""}`,onClick:()=>{w({...i,isMale:!1})},children:h("APPS.TINDER.FEMALE")})]})}),e("div",{className:"button gradient",onClick:()=>T(v),children:h("APPS.TINDER.CONTINUE")})]})})}const ce=Ve(null);function tt(){var M;const{View:t,User:s}=m.useContext(z);j(Y.Settings);const r=j(Y.PhoneNumber),[g,E]=s,[I,o]=t,f=j(ce),[l,v]=m.useState([]),[u,c]=m.useState(0),[p,i]=m.useState(!1),[w,T]=m.useState(!1),y=m.useRef(null),A=m.useRef(0),[d,P]=m.useState({content:"",attachments:[]});m.useEffect(()=>{de("Tinder")&&L("Tinder",{action:"getMessages",page:0,number:g.number},$.messages[g.number]).then(n=>{n&&n.length>0?v(n.reverse()):i(!0)})},[]);const R=()=>{if(d.content.length===0&&d.attachments.length===0)return;const n={sender:r,recipient:g.number,content:d.content,attachments:d.attachments,timestamp:new Date().getTime()};L("Tinder",{action:"sendMessage",data:n},!0).then(S=>{if(!S)return Z("error","Failed to send message");y.current.value="",P({content:"",attachments:[]}),v([...l,n])})},b=()=>{if(p||w)return;let n=document.querySelector("#last");if(!n)return;!We(n)&&(T(!0),L("Tinder",{action:"getMessages",page:u+1,number:g.number},null).then(D=>{if(D&&D.length>0){let V=document.querySelector(".message-container");A.current=V.scrollHeight,v([...D.reverse(),...l]),T(!1)}else i(!0)}),c(D=>D+1))};return m.useEffect(()=>{let n=document.querySelector(".message-container");const S=n.scrollHeight;n.scrollTop+=S-A.current,n.scroll},[l]),Me("tinder:newMessage",n=>{g.number===n.sender&&v([...l,n])}),a("div",{className:"home-wrapper slide left",children:[e(ye,{children:f&&e(st,{})}),a("div",{className:"message-header",children:[e(Fe,{onClick:()=>{o("messageList"),E(null)}}),a("div",{className:"user",onClick:()=>ce.set(g),children:[e("img",{className:"profile-picture",src:(M=g.photos)==null?void 0:M[0]}),e("div",{className:"name",children:g.name})]})]}),e("div",{className:"message-container",onScroll:b,children:e("div",{className:"message-body",children:l.map((n,S)=>{var te,se,ae,q;let D,V=S===0?"last":"",H=n.sender===r?"self":"other",K=((te=l[S+1])==null?void 0:te.sender)===r?"self":"other";return l[S+1]?D=Math.abs(n.timestamp-l[S+1].timestamp)/36e5:K=void 0,a("div",{className:`message ${H}`,id:V,children:[H=="other"?a("div",{className:"message-with-pfp",children:[e("div",{className:`profile-picture ${H!==K?"show":"hide"}`,children:e("img",{src:(se=g.photos)==null?void 0:se[0]})}),a("div",{className:"message-content",children:[n.content&&e("div",{className:"content",children:be(n.content)}),((ae=n.attachments)==null?void 0:ae.length)>0&&e("div",{className:"attatchments",children:n.attachments.map((k,F)=>ue(k)?e("video",{src:k,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:N=>{B.FullscreenImage.set({display:!0,image:k})}},F):e(Ue,{src:k,onClick:()=>{B.FullscreenImage.set({display:!0,image:k})}},F))})]})]}):a(W,{children:[n.content&&e("div",{className:"content",children:be(n.content)}),((q=n.attachments)==null?void 0:q.length)>0&&e("div",{className:"attatchments",children:n.attachments.map((k,F)=>ue(k)?e("video",{src:k,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:()=>{B.FullscreenImage.set({display:!0,image:k})}},F):e("img",{src:k,onClick:()=>{B.FullscreenImage.set({display:!0,image:k})}},F))})]}),l[S+1]&&D>6?e("div",{className:"date",children:Ee(n.timestamp)}):H!==K&&e("div",{className:"date",children:Ee(n.timestamp)})]},S)})})}),e("div",{className:"attachments",children:d.attachments.map((n,S)=>a("div",{className:"attachment",children:[ue(n)?e("video",{src:n,controls:!1,muted:!0,loop:!0,autoPlay:!0}):e("img",{src:n}),e(ee,{onClick:()=>{P({...d,attachments:d.attachments.filter((D,V)=>V!==S)})}})]}))}),a("div",{className:"message-bottom",children:[e($e,{className:"image",onClick:()=>{var n,S,D;d.attachments.length<3&&B.Gallery.set({includeVideos:!0,allowExternal:(D=(S=(n=re)==null?void 0:n.value)==null?void 0:S.AllowExternal)==null?void 0:D.Messages,onSelect:V=>P({...d,attachments:[...d.attachments,V.src]})})}}),a("div",{className:"input",children:[e(U,{type:"text",placeholder:"Type a message...",ref:y,onChange:n=>{P({...d,content:n.target.value})},onKeyDown:n=>{n.key==="Enter"&&R()}}),e(He,{className:d.attachments.length>0||d.content.length>0?"active":"",onClick:()=>R()})]})]})]})}const st=()=>{const t=j(ce),[s,r]=m.useState(0);return t?a(Se.div,{initial:{opacity:0,y:500},animate:{opacity:1,y:0},exit:{opacity:0,y:500},className:"popup-profile-container",children:[a("div",{className:"gallery",children:[e("img",{src:t==null?void 0:t.photos[s],onClick:()=>{t&&r(s<(t==null?void 0:t.photos.length)-1?s+1:0)}}),(t==null?void 0:t.photos.length)>1&&e("div",{className:"image-count",children:t==null?void 0:t.photos.map((g,E)=>e("div",{className:Be("image",E==s&&"active"),onClick:I=>{I.stopPropagation(),r(E)}}))}),e("div",{className:"close",onClick:()=>ce.set(null),children:e(ee,{})})]}),a("div",{className:"card-content",children:[a("div",{className:"name",children:[t==null?void 0:t.name,", ",e("span",{children:Q(t==null?void 0:t.dob)})]}),e("div",{className:"divider"}),a("div",{className:"description",children:[e("div",{className:"title",children:"About Me"}),t==null?void 0:t.bio]})]})]}):null};function at(){const{View:t,User:s}=m.useContext(z),[r,g]=s,[E,I]=t,[o,f]=m.useState({newMatches:[],messages:[]});return m.useEffect(()=>{de("Tinder")&&(Y.Styles.TextColor.set("#000000"),L("Tinder",{action:"getMatches"},{newMatches:$.accounts.filter(l=>l.matched&&!$.messages[l.number]),messages:$.accounts.filter(l=>$.messages[l.number])}).then(l=>{if(!l)return Z("warning","No response received from Tinder getMatches");f(l)}))},[]),Me("tinder:newMessage",l=>{let v=l.sender,u=JSON.parse(JSON.stringify(o)),c=u.messages.findIndex(p=>p.number===v);if(c!==-1)u.messages.unshift(u.messages.splice(c,1)[0]);else if(c=u.newMatches.findIndex(p=>p.number===v),c!==-1)u.messages.unshift(u.newMatches.splice(c,1)[0]);else return;u.messages[0].lastMessage=l.content,f(u)}),a("div",{className:"home-wrapper slide left",children:[e(Ne,{}),e(Ge,{placeholder:h("APPS.TINDER.SEARCH_MATCHES"),onChange:()=>{}})," ",a("div",{className:"message-list-body",children:[a("div",{className:"new-matches",children:[a("div",{className:"title",children:[h("APPS.TINDER.NEW_MATCHES"),o.newMatches.length>0&&e("span",{children:o.newMatches.length})]}),e("div",{className:"matches",children:o.newMatches.map((l,v)=>{var u;return a("div",{className:"new-match",onClick:()=>{g(l),I("message")},children:[e("img",{className:"profile-picture",src:(u=l.photos)==null?void 0:u[0]}),e("div",{className:"name",children:l.name})]},v)})})]}),a("div",{className:"recent-messages",children:[e("div",{className:"title",children:h("APPS.TINDER.MESSAGES")}),e("div",{className:"messages",children:o.messages.map((l,v)=>{var u,c;return((u=l.lastMessage)==null?void 0:u.length)===0&&(l.lastMessage=h("APPS.MESSAGES.SENT_A_PHOTO")),a("div",{className:"message",onClick:()=>{g(l),I("message")},children:[e("img",{className:"profile-picture",src:(c=l.photos)==null?void 0:c[0]}),a("div",{className:"user",children:[e("div",{className:"name",children:l.name}),e("div",{className:"message",children:l.lastMessage.length>40?l.lastMessage.substring(0,40)+"...":l.lastMessage})]})]},v)})})]})]})]})}function nt(){var l,v;const{Account:t,LoggedIn:s}=m.useContext(z),[r,g]=s,[E,I]=t,[o,f]=m.useState(E);return a("div",{className:"home-wrapper slide right",style:{backgroundColor:"#F6F6F6"},children:[e(Ne,{}),a("div",{className:"profile-body",children:[a("div",{className:"user",children:[e("img",{className:"profile-picture",src:o.photos[0]}),a("div",{className:"name",children:[o.name,", ",Q(o.dob)]})]}),a("div",{className:"inputs",children:[a("div",{className:"input",children:[e("div",{className:"label",children:h("APPS.TINDER.NAME")}),e(U,{type:"text",defaultValue:o.name,maxLength:10,onChange:u=>{f({...o,name:u.target.value})}})]}),a("div",{className:"input center",children:[e("div",{className:"label",children:h("APPS.TINDER.PHOTOS")}),e("div",{className:"photo-grid",children:[...Array(6)].map((u,c)=>{var i;let p=((i=o.photos)==null?void 0:i[c-1])||c==0;return o.photos[c]?e("div",{className:"photo",style:{backgroundImage:`url(${o.photos[c]})`},children:e("div",{className:"photo-button remove",onClick:()=>{let w=o.photos;w.splice(c,1),f({...o,photos:w})},children:e(ee,{})})},c):e("div",{className:"photo",children:p&&e("div",{className:"photo-button add",onClick:()=>{var w,T,y;B.Gallery.set({allowExternal:(y=(T=(w=re)==null?void 0:w.value)==null?void 0:T.AllowExternal)==null?void 0:y.Spark,onSelect:A=>f({...o,photos:[...o.photos,A.src]})})},children:e(Te,{})})})})})]}),a("div",{className:"input",children:[e("div",{className:"label",children:h("APPS.TINDER.ABOUT_ME")}),e(Ae,{type:"text",defaultValue:o.bio,maxLength:100,onChange:u=>{f({...o,bio:u.target.value})}})]}),a("div",{className:"input",children:[e("div",{className:"label",children:h("APPS.TINDER.INTERESTED_IN")}),a("select",{value:o.showMen&&o.showWomen?"Everyone":o.showMen?"Men":"Women",onChange:u=>{switch(u.target.value){case"Everyone":f({...o,showMen:!0,showWomen:!0});break;case"Men":f({...o,showMen:!0,showWomen:!1});break;case"Women":f({...o,showMen:!1,showWomen:!0});break}},children:[e("option",{value:"Men",children:h("APPS.TINDER.MEN")}),e("option",{value:"Women",children:h("APPS.TINDER.WOMEN")}),e("option",{value:"Everyone",children:h("APPS.TINDER.EVERYONE")})]})]}),a("div",{className:"input",children:[e("div",{className:"label",children:h("APPS.TINDER.GENDER")}),a("select",{value:o.isMale?"male":"female",onChange:u=>{u.target.value=="male"?f({...o,isMale:!0}):f({...o,isMale:!1})},children:[e("option",{value:"male",children:h("APPS.TINDER.MALE")}),e("option",{value:"female",children:h("APPS.TINDER.FEMALE")})]})]}),a("div",{className:"input",children:[e("div",{className:"label",children:h("APPS.TINDER.VISIBILITY")}),a("select",{value:o.active?"visible":"hidden",onChange:u=>{let c=u.target.value;f({...o,active:c==="visible"})},children:[e("option",{value:"visible",children:h("APPS.TINDER.VISIBLE")}),e("option",{value:"hidden",children:h("APPS.TINDER.HIDDEN")})]}),!o.active&&e("div",{className:"warning",children:h("APPS.TINDER.HIDDEN_WARNING")})]})]}),((v=(l=re)==null?void 0:l.value)==null?void 0:v.DeleteAccount.Spark)&&e("div",{className:"button red",onClick:()=>{Ye("Tinder",()=>{I(null),g(!1)},!0)},children:h("APPS.TINDER.DELETE_ACCOUNT")}),e("div",{className:"button gradient",onClick:()=>{o.name.length>=2&&o.bio.length>=5&&o.photos.length>=1?L("Tinder",{action:"saveProfile",data:o},!0).then(u=>{if(!u)return Z("error","Issue saving tinder profile");G.APPS.TINDER.account.set(o),I(o)}):Z("error","Issue saving tinder profile, (name not 2 characters, bio not over 5 or no photos)")},children:h("APPS.TINDER.SAVE")})]})]})}const z=m.createContext(null);function rt(){const t=j(Y.Settings),[s,r]=m.useState(!1),[g,E]=m.useState(null),[I,o]=m.useState(null),[f,l]=m.useState("home"),[v,u]=m.useState(!0),c={home:e(Ze,{}),profile:e(nt,{}),messageList:e(at,{}),message:e(tt,{})};return m.useEffect(()=>{if(G.APPS.TINDER.account.value){E(G.APPS.TINDER.account.value),r(!0),u(!1);return}else if(G.APPS.TINDER.account.value===!1)return u(!1);L("Tinder",{action:"isLoggedIn"},$.account).then(p=>{p?(E(p),r(!0),G.APPS.TINDER.account.set(p)):G.APPS.TINDER.account.set(!1),u(!1)})},[]),m.useEffect(()=>(f==="message"?me.ReceiveAppNotifications.set(!1):me.ReceiveAppNotifications.set(!0),()=>{me.ReceiveAppNotifications.set(!0)}),[f]),e("div",{className:"tinder-container",children:e(z.Provider,{value:{LoggedIn:[s,r],Account:[g,E],User:[I,o],View:[f,l]},children:v||t!=null&&t.airplaneMode?e("div",{className:"loading",children:e(ze,{size:40,lineWeight:5,speed:2,color:"#000000"})}):s?c[f]:e(et,{})})})}function Q(t){var s=+new Date(t);return~~((Date.now()-s)/315576e5)}export{z as TinderContext,rt as default,Q as getAge};
